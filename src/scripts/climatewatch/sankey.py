

# Sankey data extracted from https://www.climatewatchdata.org/visualizations/sankey-global-2020/index.html

total_ghg_emissions = 47463.16727

sankey_data = [{
                    "source": "Energy: Electricity and Heat",
                    "target": "Residential Buildings",
                    "value": 7.315
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Commercial Buildings",
                    "value": 4.556
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Agriculture & Fishing Energy Use",
                    "value": 0.973
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Unallocated Fuel Combustion",
                    "value": 6.302
                }, {
                    "source": "Energy: Buildings",
                    "target": "Residential Buildings",
                    "value": 4.152
                }, {
                    "source": "Energy: Buildings",
                    "target": "Commercial Buildings",
                    "value": 2.122
                }, {
                    "source": "Energy: Other Fuel Combustion",
                    "target": "Agriculture & Fishing Energy Use",
                    "value": 0.887
                }, {
                    "source": "Energy: Other Fuel Combustion",
                    "target": "Unallocated Fuel Combustion",
                    "value": 0.332
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Mining and quarrying",
                    "value": 0.256
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Construction",
                    "value": 0.305
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Iron and steel",
                    "value": 4.499
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Chemical and petrochemical",
                    "value": 1.78
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Non-ferrous metals",
                    "value": 0.344
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Non-metallic minerals",
                    "value": 2.357
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Transport equipment",
                    "value": 0.081
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Machinery",
                    "value": 0.265
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Food and tobacco",
                    "value": 0.46
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Paper, pulp and printing",
                    "value": 0.259
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Wood and wood products",
                    "value": 0.041
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Textile and leather",
                    "value": 0.109
                }, {
                    "source": "Energy: Manufacturing and Construction",
                    "target": "Other Industry",
                    "value": 2.343
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Mining and quarrying",
                    "value": 0.492
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Construction",
                    "value": 0.24
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Iron and steel",
                    "value": 1.727
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Chemical and petrochemical",
                    "value": 2.149
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Non-ferrous metals",
                    "value": 1.419
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Non-metallic minerals",
                    "value": 0.808
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Transport equipment",
                    "value": 0.375
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Machinery",
                    "value": 1.286
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Food and tobacco",
                    "value": 0.743
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Paper, pulp and printing",
                    "value": 0.471
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Wood and wood products",
                    "value": 0.141
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Textile and leather",
                    "value": 0.479
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Other Industry",
                    "value": 2.022
                }, {
                    "source": "Energy: Transportation",
                    "target": "Road",
                    "value": 11.874
                }, {
                    "source": "Energy: Transportation",
                    "target": "Rail",
                    "value": 0.179
                }, {
                    "source": "Energy: Transportation",
                    "target": "Pipeline",
                    "value": 0.295
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Road",
                    "value": 0.116
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Rail",
                    "value": 0.302
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Pipeline",
                    "value": 0.024
                }, {
                    "source": "Energy: Transportation",
                    "target": "Air",
                    "value": 0.604
                }, {
                    "source": "Energy: International Bunker",
                    "target": "Air",
                    "value": 0.627
                }, {
                    "source": "Energy: Transportation",
                    "target": "Ship",
                    "value": 0.339
                }, {
                    "source": "Energy: International Bunker",
                    "target": "Ship",
                    "value": 1.348
                }, {
                    "source": "Energy: Transportation",
                    "target": "Other Transportation",
                    "value": 0.075
                }, {
                    "source": "Energy: Electricity and Heat",
                    "target": "Other Transportation",
                    "value": 0.016
                }, {
                    "source": "Energy: Fugitive Emissions",
                    "target": "Flared",
                    "value": 0.959
                }, {
                    "source": "Energy: Fugitive Emissions",
                    "target": "Production",
                    "value": 0.524
                }, {
                    "source": "Energy: Fugitive Emissions",
                    "target": "Transmission and distribution",
                    "value": 0.568
                }, {
                    "source": "Energy: Fugitive Emissions",
                    "target": "Vented",
                    "value": 4.511
                }, {
                    "source": "Energy: Fugitive Emissions",
                    "target": "Unallocated Fuel Combustion",
                    "value": 0.21
                }, {
                    "source": "Industrial Processes",
                    "target": "Cement",
                    "value": 3.437
                }, {
                    "source": "Industrial Processes",
                    "target": "Non-ferrous metals",
                    "value": 0.093
                }, {
                    "source": "Industrial Processes",
                    "target": "Chemical and petrochemical",
                    "value": 2.633
                }, {
                    "source": "Industrial Processes",
                    "target": "Electronics",
                    "value": 0.135
                }, {
                    "source": "Industrial Processes",
                    "target": "Other Industry",
                    "value": 0.148
                }, {
                    "source": "Industrial Processes",
                    "target": "Electric Power Systems",
                    "value": 0.137
                }, {
                    "source": "Agriculture",
                    "target": "Livestock & Manure",
                    "value": 6.166
                }, {
                    "source": "Agriculture",
                    "target": "Rice Cultivation",
                    "value": 1.29
                }, {
                    "source": "Agriculture",
                    "target": "Agriculture Soils",
                    "value": 4.371
                }, {
                    "source": "Agriculture",
                    "target": "Burning",
                    "value": 0.52
                }, {
                    "source": "Land Use Change and Forestry",
                    "target": "Forest Land",
                    "value": 0.648
                }, {
                    "source": "Land Use Change and Forestry",
                    "target": "Fires in organic soils",
                    "value": 0.096
                }, {
                    "source": "Land Use Change and Forestry",
                    "target": "Forest fires",
                    "value": 0.439
                }, {
                    "source": "Land Use Change and Forestry",
                    "target": "Drained organic soils",
                    "value": 1.746
                }, {
                    "source": "Waste",
                    "target": "Landfills",
                    "value": 2.089
                }, {
                    "source": "Waste",
                    "target": "Other Waste",
                    "value": 0.061
                }, {
                    "source": "Waste",
                    "target": "Wastewater",
                    "value": 1.33
                }, {
                    "source": "Residential Buildings",
                    "target": "CO2",
                    "value": 11.39
                }, {
                    "source": "Commercial Buildings",
                    "target": "CO2",
                    "value": 6.183
                }, {
                    "source": "Commercial Buildings",
                    "target": "CH4",
                    "value": 0.474
                }, {
                    "source": "Commercial Buildings",
                    "target": "N2O",
                    "value": 0.02
                }, {
                    "source": "Residential Buildings",
                    "target": "CH4",
                    "value": 0.072
                }, {
                    "source": "Residential Buildings",
                    "target": "N2O",
                    "value": 0.005
                }, {
                    "source": "Agriculture & Fishing Energy Use",
                    "target": "CO2",
                    "value": 1.84
                }, {
                    "source": "Unallocated Fuel Combustion",
                    "target": "CO2",
                    "value": 6.479
                }, {
                    "source": "Agriculture & Fishing Energy Use",
                    "target": "CH4",
                    "value": 0.02
                }, {
                    "source": "Agriculture & Fishing Energy Use",
                    "target": "N2O",
                    "value": 0
                }, {
                    "source": "Unallocated Fuel Combustion",
                    "target": "CH4",
                    "value": 0.24
                }, {
                    "source": "Unallocated Fuel Combustion",
                    "target": "N2O",
                    "value": 0.125
                }, {
                    "source": "Mining and quarrying",
                    "target": "CO2",
                    "value": 0.749
                }, {
                    "source": "Construction",
                    "target": "CO2",
                    "value": 0.545
                }, {
                    "source": "Iron and steel",
                    "target": "CO2",
                    "value": 6.225
                }, {
                    "source": "Chemical and petrochemical",
                    "target": "CO2",
                    "value": 3.93
                }, {
                    "source": "Non-ferrous metals",
                    "target": "CO2",
                    "value": 1.763
                }, {
                    "source": "Non-metallic minerals",
                    "target": "CO2",
                    "value": 3.165
                }, {
                    "source": "Transport equipment",
                    "target": "CO2",
                    "value": 0.456
                }, {
                    "source": "Machinery",
                    "target": "CO2",
                    "value": 1.551
                }, {
                    "source": "Food and tobacco",
                    "target": "CO2",
                    "value": 1.203
                }, {
                    "source": "Paper, pulp and printing",
                    "target": "CO2",
                    "value": 0.731
                }, {
                    "source": "Wood and wood products",
                    "target": "CO2",
                    "value": 0.182
                }, {
                    "source": "Textile and leather",
                    "target": "CO2",
                    "value": 0.588
                }, {
                    "source": "Other Industry",
                    "target": "CO2",
                    "value": 4.275
                }, {
                    "source": "Other Industry",
                    "target": "CH4",
                    "value": 0.045
                }, {
                    "source": "Other Industry",
                    "target": "N2O",
                    "value": 0.193
                }, {
                    "source": "Road",
                    "target": "CO2",
                    "value": 11.641
                }, {
                    "source": "Rail",
                    "target": "CO2",
                    "value": 0.481
                }, {
                    "source": "Pipeline",
                    "target": "CO2",
                    "value": 0.319
                }, {
                    "source": "Road",
                    "target": "CH4",
                    "value": 0.086
                }, {
                    "source": "Road",
                    "target": "N2O",
                    "value": 0.263
                }, {
                    "source": "Air",
                    "target": "CO2",
                    "value": 1.226
                }, {
                    "source": "Air",
                    "target": "CH4",
                    "value": 0
                }, {
                    "source": "Air",
                    "target": "N2O",
                    "value": 0.005
                }, {
                    "source": "Ship",
                    "target": "CO2",
                    "value": 1.674
                }, {
                    "source": "Ship",
                    "target": "CH4",
                    "value": 0.003
                }, {
                    "source": "Ship",
                    "target": "N2O",
                    "value": 0.01
                }, {
                    "source": "Other Transportation",
                    "target": "CH4",
                    "value": 0.002
                }, {
                    "source": "Other Transportation",
                    "target": "N2O",
                    "value": 0.03
                }, {
                    "source": "Other Transportation",
                    "target": "CO2",
                    "value": 0.06
                }, {
                    "source": "Flared",
                    "target": "CH4",
                    "value": 0.565
                }, {
                    "source": "Flared",
                    "target": "CO2",
                    "value": 0.394
                }, {
                    "source": "Production",
                    "target": "CH4",
                    "value": 0.524
                }, {
                    "source": "Transmission and distribution",
                    "target": "CH4",
                    "value": 0.568
                }, {
                    "source": "Vented",
                    "target": "CH4",
                    "value": 4.511
                }, {
                    "source": "Cement",
                    "target": "CO2",
                    "value": 3.437
                }, {
                    "source": "Non-ferrous metals",
                    "target": "F-Gases",
                    "value": 0.093
                }, {
                    "source": "Chemical and petrochemical",
                    "target": "F-Gases",
                    "value": 2.21
                }, {
                    "source": "Chemical and petrochemical",
                    "target": "N2O",
                    "value": 0.423
                }, {
                    "source": "Electronics",
                    "target": "F-Gases",
                    "value": 0.135
                }, {
                    "source": "Electric Power Systems",
                    "target": "F-Gases",
                    "value": 0.137
                }, {
                    "source": "Livestock & Manure",
                    "target": "CH4",
                    "value": 5.882
                }, {
                    "source": "Livestock & Manure",
                    "target": "N2O",
                    "value": 0.284
                }, {
                    "source": "Rice Cultivation",
                    "target": "CH4",
                    "value": 1.29
                }, {
                    "source": "Agriculture Soils",
                    "target": "N2O",
                    "value": 4.371
                }, {
                    "source": "Burning",
                    "target": "N2O",
                    "value": 0.27
                }, {
                    "source": "Burning",
                    "target": "CH4",
                    "value": 0.25
                }, {
                    "source": "Forest Land",
                    "target": "CO2",
                    "value": 0.648
                }, {
                    "source": "Fires in organic soils",
                    "target": "CO2",
                    "value": 0.023
                }, {
                    "source": "Fires in organic soils",
                    "target": "CH4",
                    "value": 0.074
                }, {
                    "source": "Forest fires",
                    "target": "CH4",
                    "value": 0.21
                }, {
                    "source": "Forest fires",
                    "target": "N2O",
                    "value": 0.229
                }, {
                    "source": "Drained organic soils",
                    "target": "CO2",
                    "value": 1.746
                }, {
                    "source": "Landfills",
                    "target": "CH4",
                    "value": 2.089
                }, {
                    "source": "Other Waste",
                    "target": "CH4",
                    "value": 0.036
                }, {
                    "source": "Other Waste",
                    "target": "N2O",
                    "value": 0.025
                }, {
                    "source": "Wastewater",
                    "target": "CH4",
                    "value": 1.049
                }, {
                    "source": "Wastewater",
                    "target": "N2O",
                    "value": 0.281
                }]

sectors = {
    "transport": [
        "Air", # Energy: Transportation (0.604), Energy: International Bunker (0.627)
        "Rail", # Energy: Transportation (0.179), Energy: Electricity and Heat (0.302)
        "Road", # Energy: Transportation (11.874), Energy: Electricity and Heat (0.116)
        "Ship", # Energy: Transportation (0.339), Energy: International Bunker (1.348)
        "Other Transportation", # Energy: Transportation (0.075), Energy: Electricity and Heat (0.016)
        "Pipeline", # Energy: Transportation (0.295), Energy: Electricity and Heat (0.024)
    ],
    "industry": [
        "Cement", # Industrial Processes (3.437)
        "Chemical and petrochemical", # Energy: Manufacturing and Construction (1.78), Energy: Electricity and Heat (2.149), Industrial Processes (2.633)
        "Electric Power Systems", # Industrial Processes (0.137)
        "Electronics", # Industrial Processes (0.135)
        "Food and tobacco", # Energy: Manufacturing and Construction (0.46), Energy: Electricity and Heat (0.743)
        "Iron and steel", # Energy: Manufacturing and Construction (4.499), Energy: Electricity and Heat (1.727)
        "Machinery", # Energy: Manufacturing and Construction (0.265), Energy: Electricity and Heat (1.286)
        "Mining and quarrying", # Energy: Manufacturing and Construction (0.256), Energy: Electricity and Heat (0.492)
        "Non-ferrous metals", # Energy: Manufacturing and Construction (0.344), Energy: Electricity and Heat (1.419), Industrial Processes (0.093)
        "Non-metallic minerals", # Energy: Manufacturing and Construction (2.357), Energy: Electricity and Heat (0.808)
        "Other Industry", # Energy: Manufacturing and Construction (2.343), Energy: Electricity and Heat (2.022), Industrial Processes (0.148)
        "Paper, pulp and printing", # Energy: Manufacturing and Construction (0.259), Energy: Electricity and Heat (0.471)
        "Textile and leather", # Energy: Manufacturing and Construction (0.109), Energy: Electricity and Heat (0.479)
        "Transport equipment", # Energy: Manufacturing and Construction (0.081), Energy: Electricity and Heat (0.375)
    ],
    "afolu": [
        "Agriculture & Fishing Energy Use", # Energy: Electricity and Heat (0.973), Energy: Other Fuel Combustion (0.887)
        "Agriculture Soils", # Agriculture (4.371)
        "Burning", # Agriculture (0.52)
        "Drained organic soils", # Land Use Change and Forestry (1.746)
        "Fires in organic soils", # Land Use Change and Forestry (0.096)
        "Forest Land", # Land Use Change and Forestry (0.648)
        "Forest fires", # Land Use Change and Forestry (0.439)
        "Livestock & Manure", # Agriculture (6.166)
        "Rice Cultivation", # Agriculture (1.29)
        "Wood and wood products", # Energy: Manufacturing and Construction (0.041), Energy: Electricity and Heat (0.141)
    ],
    "buildings": [
        "Commercial Buildings", # Energy: Electricity and Heat (4.556), Energy: Buildings (2.122)
        "Construction", # Energy: Manufacturing and Construction (0.305), Energy: Electricity and Heat (0.24)
        "Residential Buildings", # Energy: Electricity and Heat (7.315), Energy: Buildings (4.152)
    ],
    "energy": [
        "Flared", # Energy: Fugitive Emissions (0.959)
        "Production", # Energy: Fugitive Emissions (0.524)
        "Transmission and distribution", # Energy: Fugitive Emissions (0.568)
        "Unallocated Fuel Combustion", # Energy: Electricity and Heat (6.302), Energy: Other Fuel Combustion (0.332), Energy: Fugitive Emissions (0.21)
        "Vented", # Energy: Fugitive Emissions (4.511)
    ],
    "waste": [
        "Landfills", # Waste (2.089)
        "Other Waste", # Waste (0.061)
        "Wastewater", # Waste (1.33)
    ]
}



if False:
    subsectors = []
    sources = {}
    for item in sankey_data:
        if item['target'] in [ 'CO2', 'CH4', 'N2O', 'F-Gases']:
            if item['source'] not in subsectors:
                subsectors.append(item['source'])
                for item2 in sankey_data:
                    if item2['target'] == item['source']:
                        bit = f"{item2['source']} ({item2['value']})"
                        if item['source'] not in sources:
                            sources[item['source']] = bit
                        else:
                            sources[item['source']] += ', ' + bit

    subsectors.sort()
    for s in subsectors:
        print(f'                     "{s}", # {sources[s]}')    

total_emissions = 0
total_co2 = 0
total_ch4 = 0
total_n2o = 0
total_fgas = 0
total_percentage = 0
for sector in sectors:
    emissions = 0
    co2 = 0
    ch4 = 0
    n2o = 0
    fgas = 0
    percentage = 0
    for subsector in sectors[sector]:
        for item in sankey_data:
            if item['source'] == subsector:
                percentage += item['value']
                emissions += (item['value'] / 100.0) * total_ghg_emissions
                if item['target'] == 'CO2':
                    co2 += (item['value'] / 100.0) * total_ghg_emissions
                    total_co2 += (item['value'] / 100.0) * total_ghg_emissions
                elif item['target'] == 'CH4':
                    ch4 += (item['value'] / 100.0) * total_ghg_emissions
                    total_ch4 += (item['value'] / 100.0) * total_ghg_emissions
                elif item['target'] == 'N2O':
                    n2o += (item['value'] / 100.0) * total_ghg_emissions
                    total_n2o += (item['value'] / 100.0) * total_ghg_emissions
                elif item['target'] == 'F-Gases':
                    fgas += (item['value'] / 100.0) * total_ghg_emissions
                    total_fgas += (item['value'] / 100.0) * total_ghg_emissions
    total_emissions += emissions
    total_percentage += percentage
    
    print(f'"{sector}": {emissions} ({percentage}%)\n\tCO2: {co2}\n\tCH4: {ch4}\n\tN2O: {n2o}\n\tF-Gases: {fgas}')

print(f'Total: {total_emissions} ({total_percentage}%)\n\tCO2: {total_co2}\n\tCH4: {total_ch4}\n\tN2O: {total_n2o}\n\tF-Gases: {total_fgas}')

for sector in sectors:
    for subsector in sectors[sector]:
        percentage = 0
        emissions = 0
        co2 = 0
        ch4 = 0
        n2o = 0
        fgas = 0
        for item in sankey_data:
            if item['source'] == subsector:
                percentage += item['value']
                emissions += (item['value'] / 100.0) * total_ghg_emissions
                if item['target'] == 'CO2':
                    co2 += (item['value'] / 100.0) * total_ghg_emissions
                elif item['target'] == 'CH4':
                    ch4 += (item['value'] / 100.0) * total_ghg_emissions
                elif item['target'] == 'N2O':
                    n2o += (item['value'] / 100.0) * total_ghg_emissions
                elif item['target'] == 'F-Gases':
                    fgas += (item['value'] / 100.0) * total_ghg_emissions
    
        print(f'"{subsector}": {emissions} ({percentage}%)\n\tCO2: {co2}\n\tCH4: {ch4}\n\tN2O: {n2o}\n\tF-Gases: {fgas}')
